#include <stdio.h>
#include <stdlib.h>
#include <gcrypt.h>
#include <stdint.h>

#include <sys/mman.h>
#include <unistd.h>
#include <stdlib.h>

int main()
{
    int algo = GCRY_MD_SHA256;
    gcry_error_t err;
    gcry_md_hd_t hd;

    err = gcry_md_open(&hd, algo, 0);
    if(err)
    {
        printf("[-] Failed opening cipher: %s\n", gpg_strerror(err));
        return 1;
    }

    static const char buf[128] = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA";

    gcry_md_write(hd, buf, strlen(buf));
    gcry_md_write(hd, buf, strlen(buf));
    gcry_md_read(hd, algo);

    static const char buf2[512] = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA";
    gcry_md_write(hd, buf2, strlen(buf2));

    return 0;
}
